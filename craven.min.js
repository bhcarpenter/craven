(function(){var e=null,f,h=[],j=h.slice,k=h.splice,l=h.push,m=h.shift,n=h.pop,p=h.unshift,q=h.map;function r(a,b,c,d){b=[b,c];l.apply(b,d);return k.apply(a,b)}function s(a,b){for(var c={},d=b.length;d--;)b[d]in a&&(c[b[d]]=a[b[d]]);return c}function t(a,b){for(var c in b)a[c]=b[c]}function u(a,b){var c=a[b];return"function"===typeof c?c.call(a):c};var v={c:function(a,b,c){this.d||(this.d={},this.f={});this.d[a]||(this.d[a]=[],this.f[a]=[]);this.d[a].push(b);this.f[a].push(c||this)},b:function(a,b,c){if(this.d&&a in this.d){var d=this.d[a];a=this.f[a];for(var g=d.length;g--;)if(d[g]==b&&a[g]==c){d.splice(g,1);a.splice(g,1);break}}},a:function(a){if(this.d&&a in this.d){var b=this.d[a].slice(0),c=this.f[a].slice(0),d=b.length,g=j.call(arguments,1);for(g.push(this);d--;)b[d].apply(c[d],g)}}};function w(a){a&&this.g(a)}w.prototype.c=v.c;w.prototype.b=v.b;w.prototype.a=v.a;w.prototype.e={};w.prototype.attributes=[];f=w.prototype;f.g=function(a){this.e=a=s(a,this.attributes);t(this,a)};f.o=function(a){t(this,s(a,this.attributes))};f.toJSON=function(){return s(this,this.attributes)};f.u=function(){};f.n=function(){if(!1===this.validate())return!1;var a=this.toJSON(),b=this.e;this.e=a;var c,d={},g=!1;for(c in a)a[c]!==b[c]&&(g=d[c]=a[c]);g&&this.a("change",d,b);return!0};f.s=function(){this.a("destroy")};function x(a,b){this.model=a;b&&l.apply(this,y(this,b))}x.prototype=[];f=x.prototype;f.c=v.c;f.b=v.b;f.a=v.a;f.pop=function(){return z(this,n,this.length-1)};f.push=function(){return A(this,arguments,l,this.length)};f.shift=function(){return z(this,m,0)};f.unshift=function(){return A(this,arguments,p,0)};f.splice=function(){var a=arguments,b=y(this,j.call(a,2)),a=r(this,a[0],a[1],b);B(this,a);a.length&&this.a("remove",a);b.length&&this.a("add",b);return a};
function A(a,b,c,d){b=y(a,b);c=c.apply(a,b);a.a("add",b,d);return c}function z(a,b,c){b=b.call(a);B(a,b);b&&a.a("remove",[b],c);return b}f.m=function(a){a=r(this,0,this.length,y(this,a));B(this,a);this.a("reset",a)};f.remove=function(a){this.l(this.indexOf(a))};f.l=function(a){if(-1!=a){var b=k.call(this,a,1);B(this,b);this.a("remove",b,a)}};f.toJSON=function(){return this.map(function(a){return a.toJSON()})};
function y(a,b){var c=a.model;return q.call(b,function(a){a instanceof c||(a=new c(a));a.c("destroy",this.remove,this);return a},a)}function B(a,b){for(var c=b.length;c--;)b[c].b("destroy",a.remove,a)};function C(a,b){a&&t(this,a);if(!this.view&&!b){var c=document.createElement(u(this,"tagName"));t(c,u(this,"attributes"));this.view=c}}function D(){return new C(e,!0)}C.prototype.tagName="div";C.prototype.attributes={};C.prototype.r=function(){};var E=C.prototype.remove=function(){var a=this.view,b=a.parentNode;b&&b.removeChild(a)};function F(a,b,c){C.call(this,b,c);if(this.model=a)a=this.model,a.c("change",G,this),a.c("destroy",I,this)}F.prototype=D();F.prototype.remove=function(){var a=this.model;a.b("change",G,this);a.b("destroy",I,this);E.call(this)};function G(){this.render()}function I(){this.remove()};function J(a,b,c){C.call(this,b,c);this.collection=a;this.j=[];a&&(this.e(a,0),a=this.collection,a.c("add",this.e,this),a.c("remove",this.k,this))}J.prototype=D();J.prototype.modelControllerType=F;J.prototype.remove=function(){var a=this.collection;a.b("add",this.e,this);a.b("remove",this.k,this);E.call(this)};
J.prototype.e=function(a,b){for(var c=document.createDocumentFragment(),d=a.length,g=Array(d),H;d--;)H=g[d]=new this.modelControllerType(a[d]),c.appendChild(H.view);r(this.j,b,0,g);d=this.view;d.insertBefore(c,d.children[b])};J.prototype.k=function(a,b){for(var c=a.length,d=this.j.splice(b,c);c--;)d[c].remove()};var K={i:[],add:function(a,b,c){var d={};d.pattern=RegExp(a.replace(/(^|\/):[\w\d]*(\/|$)/,"$1(.+)$2"));d.t=b;d.q=c;this.i.push(d)},p:function(){var a=this;window.addEventListener("popstate",function(){a.h(location.pathname)},!1)},navigate:function(a){window.history.pushState({},"",a);this.h(a)},h:function(a){for(var b=this.i,c=b.length,d,g;c--;)if(d=b[c],g=d.pattern.exec(a))g.unshift(),d.t.apply(d.q,g)}};var L={};window.Craven=L;L.Events=v;v.on=v.c;v.off=v.b;v.trigger=v.a;L.Model=w;w.Prototype=function(){return new w};w.prototype.reset=w.prototype.g;w.prototype.update=w.prototype.o;w.prototype.toJSON=w.prototype.toJSON;w.prototype.validate=w.prototype.u;w.prototype.save=w.prototype.n;w.prototype.destroy=w.prototype.s;w.prototype.on=w.prototype.c;w.prototype.off=w.prototype.b;w.prototype.trigger=w.prototype.a;L.Collection=x;x.Prototype=function(){return new x(e)};x.prototype.reset=x.prototype.m;
x.prototype.remove=x.prototype.remove;x.prototype.removeAt=x.prototype.l;x.prototype.on=x.prototype.c;x.prototype.off=x.prototype.b;x.prototype.trigger=x.prototype.a;L.Controller=C;C.Prototype=D;C.prototype.render=C.prototype.r;C.prototype.remove=C.prototype.remove;L.ModelController=F;F.Prototype=function(){return new F(e,e,!0)};L.CollectionController=J;J.Prototype=function(){return new J(e,e,!0)};L.Router=K;K.add=K.add;K.activate=K.p;K.navigate=K.navigate;}());
