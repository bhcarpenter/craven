(function(){var f,g=[],h=g.slice,j=g.splice,k=g.push,l=g.shift,m=g.pop,n=g.unshift;function p(a,b,c,d){b=[b,c];k.apply(b,d);return j.apply(a,b)}function q(a,b){for(var c={},d=b.length;d--;)c[b[d]]=a[b[d]];return c}function r(a,b){for(var c in b)a[c]=b[c]};var t={d:function(a,b,c){this.b||(this.b={},this.c={});this.b[a]||(this.b[a]=[],this.c[a]=[]);this.b[a].push(b);this.c[a].push(c||this)},i:function(a,b,c){var d,e;if(this.b&&(d=this.b[a])&&(e=this.c[a]))for(a=d.length;a--;)if(d[a]==b&&e[a]==c){d.splice(a,1);e.splice(a,1);break}},a:function(a){var b,c,d,e;if(this.b&&(b=this.b[a])&&(c=this.c[a])){b=b.slice(0);c=c.slice(0);e=h.call(arguments,1);e.push(this);for(d=b.length;d--;)b[d].apply(c[d],e)}}};t.on=t.d;t.off=t.i;t.trigger=t.a;function u(a){a&&this.reset(a)}r(u.prototype,t);u.prototype.e={};u.prototype.attributes=[];f=u.prototype;f.reset=function(a){r(this,this.e=q(a,this.attributes))};f.l=function(a){r(this,q(a,this.attributes))};f.toJSON=function(){return q(this,this.attributes)};f.r=function(){};f.k=function(){if(!1!==this.validate()){var a=this.e,b=this.e=this.toJSON(),c,d={},e=!1;for(c in b)b[c]!==a[c]&&(e=d[c]=b[c]);e&&this.a("change",d,a)}};f.p=function(){this.a("destroy")};function v(a){a&&k.apply(this,w(this,a))}v.prototype=[];r(v.prototype,t);v.prototype.modelType=u;f=v.prototype;f.pop=function(){return x(this,m,this.length-1)};f.push=function(){return y(this,arguments,k,this.length)};f.shift=function(){return x(this,l,0)};f.unshift=function(){return y(this,arguments,n,0)};f.splice=function(){var a=arguments,b=w(this,h.call(a,2)),a=p(this,a[0],a[1],b);z(this,a);a.length&&this.a("remove",a);b.length&&this.a("add",b);return a};
function y(a,b,c,d){b=w(a,b);c=c.apply(a,b);a.a("add",b,d);return c}function x(a,b,c){b=b.call(a);z(a,b);b&&a.a("remove",[b],c);return b}f.reset=function(a){a=p(this,0,this.length,w(this,a));z(this,a);this.a("reset",a)};f.remove=function(a){this.j(this.indexOf(a))};f.j=function(a){if(-1!=a){var b=j.call(this,a,1);z(this,b);this.a("remove",b,a)}};f.toJSON=function(){for(var a=Array(this.length),b=this.length;b--;)a[b]=this[b].toJSON();return a};f.h=function(a,b,c){this.a("change",a,b,c)};
function w(a,b){for(var c=a.modelType,d=b.length;d--;){var e=b[d];e instanceof c||(e=b[d]=new c(e));e.d("destroy",a.remove,a);e.d("change",a.h,a)}return b}function z(a,b){for(var c=b.length;c--;)b[c].i("destroy",a.remove,a),b[c].d("change",a.h,a)};function B(a,b){a&&r(this,a);if(!this.view&&!b){var c=document.createElement(this.tagName);r(c,this.attributes);this.view=c}var d=this;this.m=function(a){var b=d.domEvents[a.type],c=d.view,A=a.target,s;for(s in b){var G=b[s];if(""===s&&c===A||-1!==h.call(c.querySelectorAll(s),0).indexOf(A))d[G](a)}};C(this,"on");D(this,"addEventListener")}B.prototype.tagName="div";B.prototype.attributes={};B.prototype.remove=function(){var a=this.view,b=a.parentNode;b&&b.removeChild(a);C(this,"off");D(this,"removeEventListener")};
function C(a,b){var c=a.model,d=a.events;if(c&&d)for(var e in d)c[b](e,a[d[e]],a)}function D(a,b){var c=a.domEvents,d=a.view;if(c&&d)for(var e in c)d[b](e,a.m,!1)};var E={g:[],add:function(a,b,c){var d={};d.pattern=RegExp(a.replace(/(^|\/):[\w\d]*(\/|$)/,"$1(.+)$2"));d.q=b;d.o=c;this.g.push(d)},n:function(){var a=this;window.addEventListener("popstate",function(){a.f(location.pathname)},!1)},navigate:function(a){window.history.pushState({},"",a);this.f(a)},f:function(a){for(var b=this.g,c=b.length,d,e;c--;)if(d=b[c],e=d.pattern.exec(a))e.unshift(),d.q.apply(d.o,e)}};var F={};window.Craven=F;F.Events=t;F.Model=u;u.Prototype=function(){return new u};u.prototype.reset=u.prototype.reset;u.prototype.update=u.prototype.l;u.prototype.toJSON=u.prototype.toJSON;u.prototype.validate=u.prototype.r;u.prototype.save=u.prototype.k;u.prototype.destroy=u.prototype.p;F.Collection=v;v.Prototype=function(){return new v};v.prototype.reset=v.prototype.reset;v.prototype.remove=v.prototype.remove;v.prototype.removeAt=v.prototype.j;F.Controller=B;
B.Prototype=function(){return new B(null,!0)};B.prototype.remove=B.prototype.remove;F.Router=E;E.add=E.add;E.activate=E.n;E.navigate=E.navigate;}());
