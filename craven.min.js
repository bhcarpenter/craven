(function(){var e,g=[],h=g.slice,j=g.splice,k=g.push,l=g.shift,m=g.pop,n=g.unshift,p=g.map;function r(a,b,c,d){b=[b,c];k.apply(b,d);return j.apply(a,b)}function s(a,b){for(var c={},d=b.length;d--;)b[d]in a&&(c[b[d]]=a[b[d]]);return c}function t(a){for(var b=h.call(arguments,1),c=0,d=b.length;c<d;c++){var f=b[c],q;for(q in f)a[q]=f[q]}return a}function u(a,b){var c=a[b];return"function"===typeof c?c.call(a):c};var v={c:function(a,b,c){this.d||(this.d={},this.e={});this.d[a]||(this.d[a]=[],this.e[a]=[]);this.d[a].push(b);this.e[a].push(c||this)},b:function(a,b,c){if(this.d&&a in this.d){var d=this.d[a];a=this.e[a];for(var f=d.length;f--;)if(d[f]==b&&a[f]==c){d.splice(f,1);a.splice(f,1);break}}},a:function(a){if(this.d&&a in this.d){var b=this.d[a].slice(0),c=this.e[a].slice(0),d=b.length,f=h.call(arguments,1);for(f.push(this);d--;)b[d].apply(c[d],f)}}};function w(a){a&&this.h(a)}w.prototype={};w.prototype.c=v.c;w.prototype.b=v.b;w.prototype.a=v.a;w.prototype.f={};w.prototype.attributes=[];e=w.prototype;e.h=function(a){this.f=a=s(a,this.attributes);t(this,a)};e.p=function(a){t(this,s(a,this.attributes))};e.toJSON=function(){return s(this,this.attributes)};e.v=function(){};e.o=function(){if(!1===this.validate())return!1;var a=this.toJSON(),b=this.f;this.f=a;var c,d={},f=!1;for(c in a)a[c]!==b[c]&&(f=d[c]=a[c]);f&&this.a("change",d,b);return!0};
e.t=function(){this.a("destroy")};function x(a,b){this.model=a;b&&k.apply(this,y(this,b))}x.prototype=[];e=x.prototype;e.c=v.c;e.b=v.b;e.a=v.a;e.pop=function(){return z(this,m,this.length-1)};e.push=function(){return A(this,arguments,k,this.length)};e.shift=function(){return z(this,l,0)};e.unshift=function(){return A(this,arguments,n,0)};e.splice=function(){var a=arguments,b=y(this,h.call(a,2)),a=r(this,a[0],a[1],b);B(this,a);a.length&&this.a("remove",a);b.length&&this.a("add",b);return a};
function A(a,b,c,d){b=y(a,b);c=c.apply(a,b);a.a("add",b,d);return c}function z(a,b,c){b=b.call(a);B(a,b);b&&a.a("remove",[b],c);return b}e.n=function(a){a=r(this,0,this.length,y(this,a));B(this,a);this.a("reset",a)};e.remove=function(a){this.m(this.indexOf(a))};e.m=function(a){if(-1!=a){var b=j.call(this,a,1);B(this,b);this.a("remove",b,a)}};e.toJSON=function(){return this.map(function(a){return a.toJSON()})};
function y(a,b){var c=a.model;return p.call(b,function(a){a instanceof c||(a=new c(a));a.c("destroy",this.remove,this);return a},a)}function B(a,b){for(var c=b.length;c--;)b[c].b("destroy",a.remove,a)};var C={view:null,tagName:"div",id:"",className:""};function D(a,b){t(this,C,a);this.view||b||(this.view=t(document.createElement(u(this,"tagName")),u(this,"attributes"),{id:u(this,"id"),className:u(this,"className")}))}D.prototype.s=function(){};var E=D.prototype.remove=function(){var a=this.view,b=a.parentNode;b&&b.removeChild(a)};function F(a,b,c){D.call(this,b,c);if(this.model=a)a=this.model,a.c("change",G,this),a.c("destroy",H,this)}F.prototype=new D(null,!0);F.prototype.remove=function(){var a=this.model;a.b("change",G,this);a.b("destroy",H,this);E.call(this)};function G(){this.render()}function H(){this.remove()};function I(a,b,c){D.call(this,b,c);this.collection=a;this.k=[];this.g(a,0);a=this.collection;a.c("add",this.g,this);a.c("remove",this.l,this)}I.prototype=new D(null,!0);I.prototype.modelControllerType=F;I.prototype.remove=function(){var a=this.collection;a.b("add",this.g,this);a.b("remove",this.l,this);E.call(this)};
I.prototype.g=function(a,b){for(var c=document.createDocumentFragment(),d=a.length,f=Array(d),q;d--;)q=f[d]=new this.modelControllerType(a[d]),c.appendChild(q.view);r(this.k,b,0,f);d=this.view;d.insertBefore(c,d.children[b])};I.prototype.l=function(a,b){for(var c=a.length,d=this.k.splice(b,c);c--;)d[c].remove()};var J={j:[],add:function(a,b,c){var d={};d.pattern=RegExp(a.replace(/(^|\/):[\w\d]*(\/|$)/,"$1(.+)$2"));d.u=b;d.r=c;this.j.push(d)},q:function(){var a=this;window.addEventListener("popstate",function(){a.i(location.pathname)},!1)},navigate:function(a){window.history.pushState({},"",a);this.i(a)},i:function(a){for(var b=this.j,c=b.length,d,f;c--;)if(d=b[c],f=d.pattern.exec(a))f.unshift(),d.u.apply(d.r,f)}};var K={};window.Craven=K;K.Events=v;v.on=v.c;v.off=v.b;v.trigger=v.a;K.Model=w;w.subtype=function(a,b){function c(){d.apply(this,arguments);b&&b.apply(this,arguments)}var d=K.Model;c.prototype=new d;c.prototype.attributes=a;return c};w.prototype.reset=w.prototype.h;w.prototype.update=w.prototype.p;w.prototype.toJSON=w.prototype.toJSON;w.prototype.validate=w.prototype.v;w.prototype.save=w.prototype.o;w.prototype.destroy=w.prototype.t;w.prototype.on=w.prototype.c;w.prototype.off=w.prototype.b;
w.prototype.trigger=w.prototype.a;K.Collection=x;x.prototype.reset=x.prototype.n;x.prototype.remove=x.prototype.remove;x.prototype.removeAt=x.prototype.m;x.prototype.on=x.prototype.c;x.prototype.off=x.prototype.b;x.prototype.trigger=x.prototype.a;K.Controller=D;D.prototype.render=D.prototype.s;D.prototype.remove=D.prototype.remove;K.ModelController=F;F.subtype=function(a){function b(){F.apply(this,arguments);a&&a.apply(this,arguments)}b.prototype=new F(null,null,!0);return b};
K.CollectionController=I;K.Router=J;J.add=J.add;J.activate=J.q;J.navigate=J.navigate;}());
